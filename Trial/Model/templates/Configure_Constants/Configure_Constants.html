<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Configure Constants</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'styles/Configure_Constants_styles.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
</head>
<body>
    <nav>
        <div class="hamburger-menu">
            <button class="hamburger-btn" onclick="toggleNavMenu()">
                <i class="fas fa-bars"></i>
            </button>
        </div>
        <div class="nav-container" id="navMenu">
            <ul class="nav-left">
                <li><a href="{% url 'home' %}">Home</a></li>
                <li><a href="#">About Us</a></li>
                <li><a href="#">Contact Us</a></li>
                <li><a href="{% url 'Blogs' %}">Blogs</a></li>
                <li><a href="{% url 'Model:Configure_Constants' %}">Carbon Footprint Analyser</a></li>
            </ul>
            <ul class="nav-right">
                <li><a href="{% url 'login' %}">Login</a></li>
                <li><a href="{% url 'signup' %}">Signup</a></li>
            </ul>
        </div>
    </nav>
    
    <div class="container">
        <form class="carbon-footprint-form">
            <h1>Configure Constants</h1>
            <h2>1. Coal</h2>
            <div class="form-group">
                <h3> i) Type of coal mine</h3>
                <div class="radio-group">
                    <div class="radio-item">
                        <input type="radio" id="open-cast" name="mine-type" value="open-cast" required onclick="toggleMineFields()">
                        <label for="open-cast">Open Cast Coal mine</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="underground" name="mine-type" value="underground" required onclick="toggleMineFields()">
                        <label for="underground">Underground Coal Mine</label>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <h3>ii) Coal Type Conversion Factor for different types of coals</h3>
                <div class="sub-fields">
                    <div class="sub-field-pair">
                        <label for="anthracite">Anthracite</label>
                        <input type="number" id="anthracite" name="anthracite" step="0.01" required>
                    </div>
                    <div class="sub-field-pair">
                        <label for="bituminous-coking">Bituminous (Coking)</label>
                        <input type="number" id="bituminous-coking" name="bituminous-coking" step="0.01" required>
                    </div>
                    <div class="sub-field-pair">
                        <label for="bituminous-non-coking">Bituminous (Non-Coking)</label>
                        <input type="number" id="bituminous-non-coking" name="bituminous-non-coking" step="0.01" required>
                    </div>
                    <div class="sub-field-pair">
                        <label for="subbituminous">Subbituminous</label>
                        <input type="number" id="subbituminous" name="subbituminous" step="0.01" required>
                    </div>
                    <div class="sub-field-single">
                        <label for="lignite">Lignite</label>
                        <input type="number" id="lignite" name="lignite" step="0.01" required>
                    </div>
                    <div class="sub-field-pair">
                        <label for="conversion-factor">Conversion Factor (add exact value)</label>
                        <input type="number" id="conversion-factor" name="conversion-factor" step="0.01" required>
                    </div>
                    <div class="sub-field-pair">
                        <label for="exclusion-factor">Exclusion Factor (add exact value)</label>
                        <input type="number" id="exclusion-factor" name="exclusion-factor" step="0.01" required>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <h3>iii) Effective CO<sub>2</sub> Emissions factor</h3>
                <h4>a) Carbon Content (CC) (Enter Carbon per mass unit energy in kg/GJ)</h4>
                <div class="sub-fields">
                    <div class="sub-field-pair">
                        <label for="cc-anthracite">Anthracite</label>
                        <input type="number" id="cc-anthracite" name="cc-anthracite" step="0.01" required>
                    </div>
                    <div class="sub-field-pair">
                        <label for="cc-bituminous-coking">Bituminous (Coking)</label>
                        <input type="number" id="cc-bituminous-coking" name="cc-bituminous-coking" step="0.01" required>
                    </div>
                    <div class="sub-field-pair">
                        <label for="cc-bituminous-non-coking">Bituminous (Non-Coking)</label>
                        <input type="number" id="cc-bituminous-non-coking" name="cc-bituminous-non-coking" step="0.01" required>
                    </div>
                    <div class="sub-field-pair">
                        <label for="cc-subbituminous">Subbituminous</label>
                        <input type="number" id="cc-subbituminous" name="cc-subbituminous" step="0.01" required>
                    </div>
                    <div class="sub-field-single">
                        <label for="cc-lignite">Lignite</label>
                        <input type="number" id="cc-lignite" name="cc-lignite" step="0.01" required>
                    </div>
                </div>
                
                <h4>b) Carbon Oxidation Factor (COF)</h4>
                <div class="sub-fields">
                    <div class="sub-field-pair">
                        <label for="cof-anthracite">Anthracite</label>
                        <input type="number" id="cof-anthracite" name="cof-anthracite" step="0.01" required>
                    </div>
                    <div class="sub-field-pair">
                        <label for="cof-bituminous-coking">Bituminous (Coking)</label>
                        <input type="number" id="cof-bituminous-coking" name="cof-bituminous-coking" step="0.01" required>
                    </div>
                    <div class="sub-field-pair">
                        <label for="cof-bituminous-non-coking">Bituminous (Non-Coking)</label>
                        <input type="number" id="cof-bituminous-non-coking" name="cof-bituminous-non-coking" step="0.01" required>
                    </div>
                    <div class="sub-field-pair">
                        <label for="cof-subbituminous">Subbituminous</label>
                        <input type="number" id="cof-subbituminous" name="cof-subbituminous" step="0.01" required>
                    </div>
                    <div class="sub-field-single">
                        <label for="cof-lignite">Lignite</label>
                        <input type="number" id="cof-lignite" name="cof-lignite" step="0.01" required>
                    </div>
                </div>
                
                <!-- Added Carbon stock loss section under Coal -->
                <div id="carbon-stock-methane" style="display: none;">
                    <h3>iv) Carbon Stock Loss - Methane Emission Factor</h3>
                    <div class="sub-fields">
                        <div class="sub-field-pair">
                            <label for="methane-anthracite">Anthracite</label>
                            <input type="number" id="methane-anthracite" name="methane-anthracite" step="0.01">
                        </div>
                        <div class="sub-field-pair">
                            <label for="methane-bituminous-coking">Bituminous (Coking)</label>
                            <input type="number" id="methane-bituminous-coking" name="methane-bituminous-coking" step="0.01">
                        </div>
                        <div class="sub-field-pair">
                            <label for="methane-bituminous-non-coking">Bituminous (Non-Coking)</label>
                            <input type="number" id="methane-bituminous-non-coking" name="methane-bituminous-non-coking" step="0.01">
                        </div>
                        <div class="sub-field-pair">
                            <label for="methane-subbituminous">Subbituminous</label>
                            <input type="number" id="methane-subbituminous" name="methane-subbituminous" step="0.01">
                        </div>
                        <div class="sub-field-single">
                            <label for="methane-lignite">Lignite</label>
                            <input type="number" id="methane-lignite" name="methane-lignite" step="0.01">
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <h2>2. Emission by equipments</h2>
                <h4>i) Diesel Powered Machinery (Enter average emission per litre)</h4>
                <div class="sub-fields">
                    <div class="sub-field-pair">
                        <label for="diesel-emission-factor">Emission Factor (kg COâ‚‚/litre)</label>
                        <input type="number" id="diesel-emission-factor" name="diesel-emission-factor" step="0.01" required>
                    </div>
                    <div class="sub-field-pair">
                        <label for="diesel-consumption-rate">Average Consumption Rate (litres/hour)</label>
                        <input type="number" id="diesel-consumption-rate" name="diesel-consumption-rate" step="0.01" required>
                    </div>
                </div>
                
                <h4>ii) Petrol Powered Machinery (Enter average emission per litre)</h4>
                <div class="sub-fields">
                    <div class="sub-field-pair">
                        <label for="petrol-emission-factor">Emission Factor (kg COâ‚‚/litre)</label>
                        <input type="number" id="petrol-emission-factor" name="petrol-emission-factor" step="0.01" required>
                    </div>
                    <div class="sub-field-pair">
                        <label for="petrol-consumption-rate">Average Consumption Rate (litres/hour)</label>
                        <input type="number" id="petrol-consumption-rate" name="petrol-consumption-rate" step="0.01" required>
                    </div>
                </div>

                <h4>iii) Explosives</h4>
                <div class="sub-fields">
                    <div class="sub-field-single">
                        <label>Configure explosives and their emission factors</label>
                        <button type="button" class="add-explosive-btn" onclick="addExplosiveField()">
                            <i class="fas fa-plus"></i> Add Explosive
                        </button>
                    </div>
                </div>
                
                <div id="explosives-container">
                    <!-- Explosive fields will be dynamically added here -->
                </div>
            </div>
            
            <div class="form-group">
                <h2>3. Electricity</h2>
                <div class="sub-fields">
                    <div class="sub-field-single">
                        <label for="grid-emission-factor">Grid Emission Factor (kg COâ‚‚/kWh)</label>
                        <input type="number" id="grid-emission-factor" name="grid-emission-factor" step="0.001" required>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <h2>4. Transportation</h2>
                <div class="sub-fields">
                    <div class="sub-field-single">
                        <label>Configure transportation types and their emission factors</label>
                        <button type="button" class="add-explosive-btn" onclick="addTransportField()">
                            <i class="fas fa-plus"></i> Add Transport
                        </button>
                    </div>
                </div>
                <div id="transportation-container">
                    <!-- Transport fields will be dynamically added here -->
                </div>
            </div>
            
            <div class="form-group">
                <h2>5. Carbon Sequestration Potential</h2>
                <div class="sub-fields">
                    <div class="sub-field-single">
                        <label for="carbon-sequestration-rate">Carbon Sequestration Rate (tCOâ‚‚/hectare/year)</label>
                        <input type="number" id="carbon-sequestration-rate" name="carbon-sequestration-rate" step="0.01" required>
                    </div>
                </div>
            </div>
            
            <!-- Open Cast specific fields -->
            <div id="open-cast-fields" class="form-group" style="display: none;">
                <h2>6. Overburdened Removal</h2>
                <div class="sub-fields">
                    <div class="sub-field-single">
                        <label for="avg-emission-factor">Average Emission Factor for diesel equipment (Emission/Tonnes of coal)</label>
                        <input type="number" id="avg-emission-factor" name="avg-emission-factor" step="0.01">
                    </div>
                </div>
            </div>
            
            <!-- Underground Coal Mine specific fields -->
            <div id="underground-fields" class="form-group" style="display: none;">
                <h2>6. Underground Mining Specific Factors</h2>
                <div class="sub-fields">
                    <div class="sub-field-single">
                        <label for="ventilation-energy">Ventilation Energy Consumption (kWh/tonne)</label>
                        <input type="number" id="ventilation-energy" name="ventilation-energy" step="0.01">
                    </div>
                </div>
            </div>
            
            <button type="submit" class="button">Save Constants</button>
        </form>
    </div>

    <script>
        function toggleMineFields() {
            const openCastFields = document.getElementById('open-cast-fields');
            const undergroundFields = document.getElementById('underground-fields');
            const carbonStockMethane = document.getElementById('carbon-stock-methane');
            const openCastRadio = document.getElementById('open-cast');
            const undergroundRadio = document.getElementById('underground');
            
            if (openCastRadio.checked) {
                openCastFields.style.display = 'block';
                undergroundFields.style.display = 'none';
                carbonStockMethane.style.display = 'none';
            } else if (undergroundRadio.checked) {
                openCastFields.style.display = 'none';
                undergroundFields.style.display = 'block';
                carbonStockMethane.style.display = 'block';
            } else {
                openCastFields.style.display = 'none';
                undergroundFields.style.display = 'none';
                carbonStockMethane.style.display = 'none';
            }
        }
        
        function generateExplosiveFields() {
            const container = document.getElementById('explosives-container');
            const count = parseInt(document.getElementById('explosives-count').value);
            
            // Clear existing fields
            container.innerHTML = '';
            
            // Generate new fields based on the count
            for (let i = 1; i <= count; i++) {
                const fieldGroup = document.createElement('div');
                fieldGroup.className = 'sub-fields explosive-fields';
                
                let removeButton = '';
                if (count > 1) {
                    removeButton = `
                        <div class="add-button-container">
                            <button type="button" class="remove-btn" onclick="removeExplosiveField(this)" title="Remove this explosive">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </div>
                    `;
                }
                
                fieldGroup.innerHTML = `
                    <h5>Explosive #${i}</h5>
                    <div class="sub-field-pair">
                        <label for="explosive-type-${i}">Type of Explosive</label>
                        <input type="text" id="explosive-type-${i}" name="explosive-type-${i}" required>
                    </div>
                    <div class="sub-field-pair">
                        <label for="explosive-emission-${i}">Emission Factor (kg COâ‚‚/kg)</label>
                        <input type="number" id="explosive-emission-${i}" name="explosive-emission-${i}" step="0.01" required>
                    </div>
                    ${removeButton}
                `;
                container.appendChild(fieldGroup);
            }
        }
        
        function removeExplosiveField(button) {
            const fieldGroup = button.closest('.explosive-fields');
            fieldGroup.remove();
            
            // Update count and renumber remaining explosives
            const container = document.getElementById('explosives-container');
            const explosiveCount = container.getElementsByClassName('explosive-fields').length;
            document.getElementById('explosives-count').value = explosiveCount;
            
            // Renumber the remaining explosives
            const explosiveFields = container.getElementsByClassName('explosive-fields');
            for (let i = 0; i < explosiveFields.length; i++) {
                const heading = explosiveFields[i].querySelector('h5');
                heading.textContent = `Explosive #${i + 1}`;
            }
        }
        
        function addTransportField() {
            transportCount++;
            const container = document.getElementById('transportation-container');
            
            const fieldGroup = document.createElement('div');
            fieldGroup.className = 'sub-fields transportation-fields';
            fieldGroup.innerHTML = `
                <h4>Transport #${transportCount}</h4>
                <div class="sub-field-pair">
                    <label for="transport-type-${transportCount}">Type of Transport</label>
                    <input type="text" id="transport-type-${transportCount}" name="transport-type-${transportCount}" required>
                </div>
                <div class="sub-field-pair">
                    <label for="transport-emission-${transportCount}">Emission Factor (kg COâ‚‚/km)</label>
                    <input type="number" id="transport-emission-${transportCount}" name="transport-emission-${transportCount}" step="0.001" required>
                </div>
                <div class="add-button-container">
                    <button type="button" class="remove-transport-btn" onclick="removeTransportField(this)" title="Remove this transport">
                        <i class="fas fa-trash-alt"></i>
                    </button>
                </div>
            `;
            container.appendChild(fieldGroup);
        }
        
        function removeTransportField(button) {
            const fieldGroup = button.closest('.transportation-fields');
            fieldGroup.remove();
            
            // Renumber the remaining transport fields
            const transportFields = document.getElementsByClassName('transportation-fields');
            
            // Update the transportCount
            transportCount = transportFields.length;
            
            // Renumber the remaining fields
            for (let i = 0; i < transportCount; i++) {
                const heading = transportFields[i].querySelector('h4'); // Changed from h5 to h4
                if (heading) {
                    heading.textContent = `Transport #${i + 1}`;
                }
                
                const typeInput = transportFields[i].querySelector('[id^="transport-type-"]');
                const emissionInput = transportFields[i].querySelector('[id^="transport-emission-"]');
                
                if (typeInput && emissionInput) {
                    typeInput.id = `transport-type-${i + 1}`;
                    typeInput.name = `transport-type-${i + 1}`;
                    emissionInput.id = `transport-emission-${i + 1}`;
                    emissionInput.name = `transport-emission-${i + 1}`;
                }
            }
        }
        
        let transportCount = 0;
        
        let explosiveCount = 0;
        
        function addExplosiveField() {
            explosiveCount++;
            const container = document.getElementById('explosives-container');
            
            const fieldGroup = document.createElement('div');
            fieldGroup.className = 'sub-fields explosive-fields';
            fieldGroup.innerHTML = `
                <h5>Explosive #${explosiveCount}</h5>
                <div class="sub-field-pair">
                    <label for="explosive-type-${explosiveCount}">Type of Explosive</label>
                    <input type="text" id="explosive-type-${explosiveCount}" name="explosive-type-${explosiveCount}" required>
                </div>
                <div class="sub-field-pair">
                    <label for="explosive-emission-${explosiveCount}">Emission Factor (kg COâ‚‚/kg)</label>
                    <input type="number" id="explosive-emission-${explosiveCount}" name="explosive-emission-${explosiveCount}" step="0.01" required>
                </div>
                <div class="add-button-container">
                    <button type="button" class="remove-btn" onclick="removeExplosiveField(this)" title="Remove this explosive">
                        <i class="fas fa-trash-alt"></i>
                    </button>
                </div>
            `;
            container.appendChild(fieldGroup);
        }
        
        function removeExplosiveField(button) {
            const fieldGroup = button.closest('.explosive-fields');
            fieldGroup.remove();
            
            // Renumber the remaining explosives
            const explosiveFields = document.getElementsByClassName('explosive-fields');
            for (let i = 0; i < explosiveFields.length; i++) {
                const heading = explosiveFields[i].querySelector('h5');
                heading.textContent = `Explosive #${i + 1}`;
                
                const typeInput = explosiveFields[i].querySelector('[id^="explosive-type-"]');
                const emissionInput = explosiveFields[i].querySelector('[id^="explosive-emission-"]');
                
                typeInput.id = `explosive-type-${i + 1}`;
                typeInput.name = `explosive-type-${i + 1}`;
                emissionInput.id = `explosive-emission-${i + 1}`;
                emissionInput.name = `explosive-emission-${i + 1}`;
            }
            
            // Update the explosiveCount
            explosiveCount = explosiveFields.length;
        }
        
        // Run on page load to handle any pre-selected values
        document.addEventListener('DOMContentLoaded', function() {
            toggleMineFields();
            generateExplosiveFields(); // Generate initial explosive field
            // Generate at least one explosive field by default
            addExplosiveField();
            addTransportField();
        });
    </script>
</body>
</html>